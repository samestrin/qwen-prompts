# ---------------------------------------------------------------------------
# Command: /performance-audit
#
# Description:
#   Calls the Gemini CLI to identify performance issues and bottlenecks.
#
# Usage Examples:
#
#   1. Run a general audit:
#      /performance-audit
#
#   2. Focus on a specific area:
#      /performance-audit focusing on database query performance
# ---------------------------------------------------------------------------

name = "performance-audit"
description = "Identify performance issues, bottlenecks, and optimization opportunities"

prompt = """
The **MAIN_DIRECTORY** is "`gemini -p "Analyze @package.json, @composer.json, or @pyproject.toml to identify the primary source code directory. Look for:

1. **pyproject.toml**: Check `[tool.setuptools.packages.find]` include patterns, `[project.scripts]` entry points, or `[tool.setuptools.package-data]` keys
2. **package.json**: Check `main`, `module`, or `exports` fields pointing to source directories
3. **composer.json**: Check `autoload.psr-4` namespace mappings

Return the actual package/module directory name that contains the application logic (not generic names like "src"). Print only the directory name without explanation.`"

You are an expert software architect/engineer.

### Performance Analysis

`gemini -p "@main_directory Perform a comprehensive performance audit of this codebase. {{args}}

1.  **Database Performance**: Inefficient queries (N+1), missing indexes, unnecessary calls.
2.  **API Performance**: Slow endpoints, missing caching, inefficient serialization.
3.  **Frontend Performance**: Large bundle sizes, inefficient rendering, unoptimized assets.
4.  **Memory Usage**: Memory leaks, large object storage, inefficient data structures.
5.  **Algorithm Efficiency**: Inefficient loops (O(n¬≤)), redundant calculations.
6.  **Async/Concurrency Issues**: Blocking operations, race conditions, missing parallelization.

**For each issue found, provide:**
- üìÅ File and line references.
- ‚ö†Ô∏è Impact level (High/Medium/Low).
- üí° Specific optimization suggestions.
- üìä Expected performance improvement.

**Priority Recommendations:**
List the top 5 optimizations that would have the biggest impact."`

---

Carefully review the output and correct any formatting issues that may have occured before display.

Then **hard stop**.
"""
